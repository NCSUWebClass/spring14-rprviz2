<!DOCTYPE html>
<meta charset="utf-8">
<link href="./lib/css/nv.d3.css" rel="stylesheet" type="text/css">
<style>

body {
  overflow-y:scroll;
}

text {
  font: 12px sans-serif;
}

.mypiechart {
  width: 500px;
  border: 2px;
}
</style>
<body class='with-3d-shadow with-transitions'>
<!--- div is used for testing purposes for the JSON object -->
<div id="placeholder"> </div>
<h2>Test1</h2>
<svg id="test1" class="mypiechart"></svg>

<h2>Test2</h2>
<svg id="test2" class="mypiechart"></svg>

<script src="http://d3js.org/d3.v2.min.js"></script>
<script src="./lib/js/legend.js"></script>
<script src="./lib/js/pie.js"></script>
<script src="./lib/js/pieChart.js"></script>
<script src="./lib/js/utils.js"></script>
<script src="http://code.jquery.com/jquery-2.1.0.min.js"></script>

<script>

 
  var testdata = [
    {
      key: "One",
      y: 5
    },
    {
      key: "Two",
      y: 2
    },
    {
      key: "Three",
      y: 9
    },
    {
      key: "Four",
      y: 7
    },
    {
      key: "Five",
      y: 4
    },
    {
      key: "Six",
      y: 3
    },
    {
      key: "Seven",
      y: .5
    }
  ];
 
  var data2012;

function getData() {
    d3.json("data.json", function(data1) {
      data2012 = data1;
      alert(data1.length)
    });

    strdata2012 = JSON.stringify(data2012);
   

    var list = "";
    for (var i = 0; i < data.length; i++) {
        list += data[i].Code + " " + data[i]["School Name"] + "<br />";
    }

    document.getElementById("placeholder").innerHTML = strdata2012;



    // E == Elementary, M == Middle School, S == High School, S/O == mixed grade level school
    sumE = 0;
    sumM = 0;
    sumS = 0;
    sumSO = 0;

    // loop to get all of the numbers associated with that school type
    for (var i = 0; i < data.length; i++) {
        if (data[i][" Level"] === "E") {
            sumE++;
        } else if (data[i][" Level"] === "M") {
            sumM++;
        } else if (data[i][" Level"] === "S") {
            sumS++;
        } else if (data[i][" Level"] === "S/O") {
            sumSO++;
        }
    }

    // setting the items in JSON to use within the graph
    // schoolData is the JSON object for this page
    var schoolData = [];
    // this collects the elementary school data so it will looks nice to the user
    item = {};
    item["title"] = "Elementary School";
    item["number"] = sumE;
    schoolData.push(item);

    // this collects the middle school data so it will looks nice to the user
    item = {};
    item["title"] = "Middle School";
    item["number"] = sumM;
    schoolData.push(item);

    // this collects the high school data so it will looks nice to the user
    item = {};
    item["title"] = "High School";
    item["number"] = sumS;
    schoolData.push(item);

    // this collects the combined school data so it will looks nice to the user
    item = {};
    item["title"] = "Combined Schooling";
    item["number"] = sumSO;
    schoolData.push(item);

   // document.getElementById("placeholder").innerHTML = schoolData[0].number;
    
//	document.getElementById("placeholder").innerHTML=data.users[0].firstName + " " + data.users[0].lastName+"--"+ data.users[0].joined.month;
//	var list = "";
//	for (var i = 0; i < data2012.users.length; i++) { 
//	   list += data2012.users[i].firstName + " " + data2012.users[i].lastName+"--"+ data2012.users[i].joined.month + "<br />";
//	}

//	document.getElementById("placeholder").innerHTML= list;
}


nv.addGraph(function() {
    var width = 500,
        height = 500;
	
    getData();
	
    var chart = nv.models.pieChart()
        .x(function(d) { return data2012["Level"] })
        .y(function(d) { return data2012["F&R"] })
        .color(d3.scale.category10().range())
        .width(width)
        .height(height);

      d3.select("#test1")
          .datum(testdata)
        .transition().duration(1200)
          .attr('width', width)
          .attr('height', height)
          .call(chart);

    chart.dispatch.on('stateChange', function(e) { nv.log('New State:', JSON.stringify(e)); });

    return chart;
});

nv.addGraph(function() {

    var width = 500,
        height = 500;

    var chart = nv.models.pieChart()
        .x(function(d) { return d.key })
        //.y(function(d) { return d.value })
        //.labelThreshold(.08)
        //.showLabels(false)
        .color(d3.scale.category10().range())
        .width(width)
        .height(height)
        .donut(true);

    chart.pie
        .startAngle(function(d) { return d.startAngle/2 -Math.PI/2 })
        .endAngle(function(d) { return d.endAngle/2 -Math.PI/2 });

      //chart.pie.donutLabelsOutside(true).donut(true);

      d3.select("#test2")
          //.datum(historicalBarChart)
          .datum(testdata)
          .transition().duration(1200)
          .attr('width', width)
          .attr('height', height)
          .call(chart);

    return chart;
});

</script>
</body>